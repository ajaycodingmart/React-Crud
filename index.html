<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>REACT CRUD</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <script src="js/script.js"></script>
    <script src="https://unpkg.com/react@latest/dist/react.js"></script>
    <script src="https://unpkg.com/react-dom@latest/dist/react-dom.js"></script>
    <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
  </head>
  <body>

    <div id="main"></div>
    <script type="text/babel">
        class Form extends React.Component{
              constructor(props){
                super(props);
                this.state = {
                  name: '',
                  email: '',
                  phone: '',
                  submit: false,
                  update: false,
                  cancel: false,
                  table: false,
                  rows: [{}],
                  updateInTable: false
                }
                this.handleSubmit = this.handleSubmit.bind(this);
                this.handleNameChange = this.handleNameChange.bind(this);
                this.handleEmailChange = this.handleEmailChange.bind(this);
                this.handlePhoneChange = this.handlePhoneChange.bind(this);
                this.cancelClick = this.cancelClick.bind(this);
                this.updateClick = this.updateClick.bind(this);
                this.submitClick = this.submitClick.bind(this);
              }

              handleSubmit = function(e){
                  e.preventDefault();
                this.setState({table: true});
                this.setState({rows: [
                  {
                    id: 1,
                    name: this.state.name,
                    email: this.state.email,
                    phone: this.state.phone
                  }
                ]
              } , () => {console.log(this.state.rows)});
                this.setState({updateInTable: true} , () => {console.log(this.state.updateInTable)})
                this.setState({submit: false});
              }
              handleNameChange =  function(e) {
                this.setState({name: e.target.value , cancel: true});
                if(e.target.value != ''){
                  this.setState({submit: true})
                }
              }
              handleEmailChange = function(e) {
                this.setState({email: e.target.value, cancel: true});
                if(e.target.value != ''){
                  this.setState({submit: true})
                }
              }
              handlePhoneChange = function(e) {
                this.setState({phone: e.target.value, cancel: true});
                if(e.target.value != ''){
                  this.setState({submit: true})
                }
              }
              submitClick = function(){
                this.setState({ cancel: false});
              }
              cancelClick = function(){
                this.setState({name: '', email: '', phone: '', cancel: false, submit: false});
              }
              updateClick = function(){
                this.setState({update: false})
              }

              render() {
              return(
                  <div className="jumbotron">
                    <center><h1 className="mb-5">React Form To Table</h1></center>
                    <form onSubmit={this.handleSubmit}>
                      <div className="col m-3">
                        <label className="col-4">Name: </label><input type="text" name="Name" value={this.state.name} onChange={this.handleNameChange} />
                      </div>
                      <div className="col m-3">
                        <label className="col-4">Email: </label><input type="email" name="Email" value={this.state.email} onChange={this.handleEmailChange} />
                      </div>
                      <div className="col m-3">
                        <label className="col-4">Phone: </label><input type="number" name="Phone" value={this.state.phone} onChange={this.handlePhoneChange} />
                      </div>
                      <div className="col-6 m-5">
                        <input className="btn btn-success" type="submit" name="Submit" disabled={!this.state.submit} onClick={this.submitClick}/>
                        <button className="btn btn-info" value={this.state.update} disabled={!this.state.update} onClick={this.updateClick}>Update</button>
                        <button className="btn btn-danger" value={this.state.cancel} disabled={!this.state.cancel} onClick={this.cancelClick}>Cancel</button>
                      </div>
                    </form>
                    <Table
                     table={this.state.table}
                     name={this.state.name}
                     rows={this.state.rows}
                     updateInTable={this.state.updateInTable}
                     />
                  </div>
              )
            }
        }
        class Table extends React.Component{
            constructor(props){
              super(props);

            }

            componentDidUpdate() {
              console.log('From table '+this.props.updateInTable);
              if(this.props.updateInTable){
                console.log('Coming from table '+this.props.rows);
              }
            }
          render(){
              return(
                <table className="table table-hover table-inverse text-center " value={this.props.table} hidden={!this.props.table} >
                  <thead>
                    <tr className="panel-heading">
                      <td>Name</td>
                      <td>Email</td>
                      <td>Phone</td>
                      <td></td>
                      <td></td>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>{this.props.name}</td>
                      <td></td>
                      <td></td>
                      <td className="table-button"><div className="btn btn-danger">Delete</div></td>
                      <td className="table-button"><div className="btn btn-primary">Edit</div></td>
                    </tr>
                  </tbody>
                </table>
              )
          }
        }
        ReactDOM.render(<Form />, document.getElementById('main'))
    </script>
  </body>
</html>
